# CVE-2021-3122

CMCAgent in NCR Command Center Agent 16.3 on Aloha POS/BOH servers permits the submission of a runCommand parameter (within an XML document sent to port 8089) that enables the remote, unauthenticated execution of an arbitrary command as SYSTEM, as exploited in the wild in 2020 and/or 2021. NOTE: the vendor's position is that exploitation occurs only on devices with a certain "misconfiguration."

### Technical Analysis

https://hcs-team.com/blog/CVE-2021-3122/

### Nuclei Template

https://github.com/Heroes-Cyber-Security/research/blob/main/CVE-2021-3122/CVE-2021-3122.yaml

### Metasploit Module

https://github.com/Heroes-Cyber-Security/research/blob/main/CVE-2021-3122/ncr_cmcagent_rce.rb